{"ast":null,"code":"import _objectSpread from\"C:/Users/vansh patel/OneDrive/Desktop/study/sem5/projects/finaurial/finaurial/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useCallback,useMemo,useRef}from'react';import axios from'../utils/axios';import{useDebounce}from'../utils/hooks';import TransactionForm from'../components/TransactionForm';import Card from'../components/Card';import{useNotification}from'../context/NotificationContext';import Modal from'react-modal';import Papa from'papaparse';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";Modal.setAppElement('#root');const TransactionsPage=()=>{const{showNotification}=useNotification();const[transactions,setTransactions]=useState([]);const[total,setTotal]=useState(0);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[filters,setFilters]=useState({type:'',category:'',startDate:'',endDate:''});const[searchTerm,setSearchTerm]=useState('');const[sort,setSort]=useState({field:'date',direction:'desc'});const[pagination,setPagination]=useState({page:1,limit:10});const debouncedSearchTerm=useDebounce(searchTerm,400);const[isModalOpen,setIsModalOpen]=useState(false);const[editingTransaction,setEditingTransaction]=useState(null);const addButtonRef=useRef(null);const queryParams=useMemo(()=>_objectSpread(_objectSpread(_objectSpread({},pagination),filters),{},{search:debouncedSearchTerm,sort:\"\".concat(sort.field,\",\").concat(sort.direction)}),[pagination,filters,debouncedSearchTerm,sort]);const fetchTransactions=useCallback(async function(){let showLoader=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;if(showLoader)setLoading(true);setError(null);try{const res=await axios.get('/transactions',{params:queryParams});setTransactions(res.data.data||[]);setTotal(res.data.total||0);}catch(err){var _err$response,_err$response$data,_err$response2,_err$response2$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||'Error fetching transactions');showNotification(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.error)||'Error fetching transactions','error');}finally{if(showLoader)setLoading(false);}},[queryParams,showNotification]);useEffect(()=>{fetchTransactions();},[fetchTransactions]);const handleSort=field=>{setSort(prev=>({field,direction:prev.field===field&&prev.direction==='asc'?'desc':'asc'}));};const handleFilterChange=e=>{setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{[e.target.name]:e.target.value}));setPagination(prev=>_objectSpread(_objectSpread({},prev),{},{page:1}));};const handleCloseModal=()=>{var _addButtonRef$current;setIsModalOpen(false);setEditingTransaction(null);(_addButtonRef$current=addButtonRef.current)===null||_addButtonRef$current===void 0?void 0:_addButtonRef$current.focus();};return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold\",children:\"Transactions\"}),/*#__PURE__*/_jsx(\"button\",{ref:addButtonRef,onClick:()=>{setEditingTransaction(null);setIsModalOpen(true);},className:\"bg-light-accent dark:bg-dark-accent text-white px-4 py-2 rounded-md min-h-[44px]\",children:\"Add Transaction\"})]}),/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value)}),/*#__PURE__*/_jsxs(\"select\",{name:\"type\",value:filters.type,onChange:handleFilterChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Types\"}),/*#__PURE__*/_jsx(\"option\",{value:\"income\",children:\"Income\"}),/*#__PURE__*/_jsx(\"option\",{value:\"expense\",children:\"Expense\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"category\",placeholder:\"Category...\",value:filters.category,onChange:handleFilterChange}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"startDate\",value:filters.startDate,onChange:handleFilterChange}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"endDate\",value:filters.endDate,onChange:handleFilterChange})]})}),/*#__PURE__*/_jsx(Modal,{isOpen:isModalOpen,onRequestClose:handleCloseModal,contentLabel:\"Transaction Form\",overlayClassName:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center\",className:\"bg-light-background dark:bg-dark-background rounded-lg shadow-xl p-6 max-w-lg w-full focus:outline-none\",children:/*#__PURE__*/_jsx(TransactionForm,{transaction:editingTransaction,onCancel:handleCloseModal,onTransactionAdded:()=>{fetchTransactions(false);handleCloseModal();},onTransactionUpdated:()=>{fetchTransactions(false);handleCloseModal();}})})]});};export default TransactionsPage;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useMemo","useRef","axios","useDebounce","TransactionForm","Card","useNotification","Modal","Papa","jsx","_jsx","jsxs","_jsxs","setAppElement","TransactionsPage","showNotification","transactions","setTransactions","total","setTotal","loading","setLoading","error","setError","filters","setFilters","type","category","startDate","endDate","searchTerm","setSearchTerm","sort","setSort","field","direction","pagination","setPagination","page","limit","debouncedSearchTerm","isModalOpen","setIsModalOpen","editingTransaction","setEditingTransaction","addButtonRef","queryParams","_objectSpread","search","concat","fetchTransactions","showLoader","arguments","length","undefined","res","get","params","data","err","_err$response","_err$response$data","_err$response2","_err$response2$data","response","handleSort","prev","handleFilterChange","e","target","name","value","handleCloseModal","_addButtonRef$current","current","focus","className","children","ref","onClick","placeholder","onChange","isOpen","onRequestClose","contentLabel","overlayClassName","transaction","onCancel","onTransactionAdded","onTransactionUpdated"],"sources":["C:/Users/vansh patel/OneDrive/Desktop/study/sem5/projects/finaurial/finaurial/src/pages/TransactionsPage.js"],"sourcesContent":["import React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\nimport axios from '../utils/axios';\nimport { useDebounce } from '../utils/hooks';\nimport TransactionForm from '../components/TransactionForm';\nimport Card from '../components/Card';\nimport { useNotification } from '../context/NotificationContext';\nimport Modal from 'react-modal';\nimport Papa from 'papaparse';\n\nModal.setAppElement('#root');\n\nconst TransactionsPage = () => {\n  const { showNotification } = useNotification();\n  const [transactions, setTransactions] = useState([]);\n  const [total, setTotal] = useState(0);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [filters, setFilters] = useState({ type: '', category: '', startDate: '', endDate: '' });\n  const [searchTerm, setSearchTerm] = useState('');\n  const [sort, setSort] = useState({ field: 'date', direction: 'desc' });\n  const [pagination, setPagination] = useState({ page: 1, limit: 10 });\n  const debouncedSearchTerm = useDebounce(searchTerm, 400);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [editingTransaction, setEditingTransaction] = useState(null);\n  const addButtonRef = useRef(null);\n\n  const queryParams = useMemo(() => ({\n    ...pagination,\n    ...filters,\n    search: debouncedSearchTerm,\n    sort: `${sort.field},${sort.direction}`,\n  }), [pagination, filters, debouncedSearchTerm, sort]);\n\n  const fetchTransactions = useCallback(async (showLoader = true) => {\n    if (showLoader) setLoading(true);\n    setError(null);\n    try {\n      const res = await axios.get('/transactions', { params: queryParams });\n      setTransactions(res.data.data || []);\n      setTotal(res.data.total || 0);\n    } catch (err) {\n      setError(err.response?.data?.error || 'Error fetching transactions');\n      showNotification(err.response?.data?.error || 'Error fetching transactions', 'error');\n    } finally {\n      if (showLoader) setLoading(false);\n    }\n  }, [queryParams, showNotification]);\n\n  useEffect(() => {\n    fetchTransactions();\n  }, [fetchTransactions]);\n\n  const handleSort = (field) => {\n    setSort(prev => ({ field, direction: prev.field === field && prev.direction === 'asc' ? 'desc' : 'asc' }));\n  };\n\n  const handleFilterChange = (e) => {\n    setFilters(prev => ({ ...prev, [e.target.name]: e.target.value }));\n    setPagination(prev => ({ ...prev, page: 1 }));\n  };\n\n  const handleCloseModal = () => {\n    setIsModalOpen(false);\n    setEditingTransaction(null);\n    addButtonRef.current?.focus();\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex justify-between items-center\">\n        <h1 className=\"text-3xl font-bold\">Transactions</h1>\n        <button ref={addButtonRef} onClick={() => { setEditingTransaction(null); setIsModalOpen(true); }} className=\"bg-light-accent dark:bg-dark-accent text-white px-4 py-2 rounded-md min-h-[44px]\">\n          Add Transaction\n        </button>\n      </div>\n\n      <Card>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-4\">\n          <input type=\"text\" placeholder=\"Search...\" value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} />\n          <select name=\"type\" value={filters.type} onChange={handleFilterChange}><option value=\"\">All Types</option><option value=\"income\">Income</option><option value=\"expense\">Expense</option></select>\n          <input type=\"text\" name=\"category\" placeholder=\"Category...\" value={filters.category} onChange={handleFilterChange} />\n          <input type=\"date\" name=\"startDate\" value={filters.startDate} onChange={handleFilterChange} />\n          <input type=\"date\" name=\"endDate\" value={filters.endDate} onChange={handleFilterChange} />\n        </div>\n        \n        {/* Content */}\n      </Card>\n\n      <Modal isOpen={isModalOpen} onRequestClose={handleCloseModal} contentLabel=\"Transaction Form\" overlayClassName=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center\" className=\"bg-light-background dark:bg-dark-background rounded-lg shadow-xl p-6 max-w-lg w-full focus:outline-none\">\n        <TransactionForm transaction={editingTransaction} onCancel={handleCloseModal} onTransactionAdded={() => { fetchTransactions(false); handleCloseModal(); }} onTransactionUpdated={() => { fetchTransactions(false); handleCloseModal(); }} />\n      </Modal>\n    </div>\n  );\n};\n\nexport default TransactionsPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}